### TCP/IP 흐름 제어와 혼잡 제어: 개념, 내용 및 예시

---

## **TCP/IP의 흐름 제어와 혼잡 제어**

TCP(Transmission Control Protocol)는 신뢰성 있는 데이터 전송을 보장하기 위해 다양한 제어 메커니즘을 제공합니다. 이 중 **흐름 제어**와 **혼잡 제어**는 네트워크 성능 최적화와 데이터 손실 방지를 위한 핵심 기능입니다.

---

## **1. 흐름 제어 (Flow Control)**

### **1.1 개념**
- **흐름 제어**는 송신 측(Sender)와 수신 측(Receiver) 간의 데이터 전송 속도를 조절하여, 수신 측이 처리할 수 있는 양만큼 데이터를 전송하도록 하는 메커니즘입니다.
- 수신 측의 처리 능력을 초과하는 데이터 전송을 방지하여 **버퍼 오버플로우(Buffer Overflow)**를 막습니다.

---

### **1.2 동작 원리**

흐름 제어는 주로 TCP의 **윈도우 크기(Window Size)**를 기반으로 동작합니다:
1. 송신 측은 수신 측이 설정한 윈도우 크기만큼 데이터를 전송합니다.
2. 수신 측은 데이터를 처리한 후, 남은 버퍼 공간을 기반으로 새로운 윈도우 크기를 송신 측에 알려줍니다.
3. 송신 측은 이 정보를 바탕으로 데이터 전송 속도를 조절합니다.

---

### **1.3 흐름 제어 방식**

#### 1) **정지-대기(Stop-and-Wait)**
- 송신 측은 한 번에 하나의 패킷만 전송하고, 수신 측의 확인 응답(ACK)을 받은 후 다음 패킷을 전송합니다.
- 단순하지만 대역폭 활용 효율이 낮습니다.

#### 2) **슬라이딩 윈도우(Sliding Window)**
- 송신 측은 윈도우 크기만큼 여러 패킷을 연속적으로 전송할 수 있습니다.
- 수신 측은 ACK를 통해 윈도우 크기를 업데이트하며, 송신 속도를 동적으로 조절합니다.

---

### **1.4 예시**

#### 흐름 제어 시나리오:
1. 수신 측 버퍼 크기가 10KB이며, 현재 5KB가 사용 중인 상태.
2. 수신 측은 남은 5KB를 송신 측에 윈도우 크기로 알림.
3. 송신 측은 최대 5KB 데이터만 전송.
4. 수신 측이 데이터를 처리한 후, 새로운 윈도우 크기를 송신 측에 전달.

---

## **2. 혼잡 제어 (Congestion Control)**

### **2.1 개념**
- **혼잡 제어**는 네트워크 내 트래픽이 과도하게 증가하여 발생하는 혼잡(Congestion)을 방지하거나 완화하는 메커니즘입니다.
- 네트워크 혼잡은 패킷 손실, 지연 증가를 초래하며, 이를 해결하기 위해 TCP는 데이터 전송 속도를 조절합니다.

---

### **2.2 동작 원리**

혼잡 제어는 주로 TCP의 **혼잡 윈도우(Congestion Window)**를 기반으로 동작하며, 네트워크 상태에 따라 윈도우 크기를 동적으로 변경합니다:
1. 초기에는 작은 크기의 혼잡 윈도우로 시작.
2. 네트워크 상태가 양호하면 혼잡 윈도우를 점진적으로 증가.
3. 패킷 손실이 발생하면 혼잡 윈도우를 감소시켜 네트워크 부하를 완화.

---

### **2.3 혼잡 제어 알고리즘**

#### 1) **Slow Start (느린 시작)**
- 초기 단계에서 혼잡 윈도우 크기를 작게 설정하고, ACK를 받을 때마다 지수적으로 증가시킵니다.
- 네트워크 용량을 초과하지 않도록 점진적으로 탐색.

#### 2) **Congestion Avoidance (혼잡 회피)**
- 혼잡 임계값(Threshold)에 도달하면 혼잡 윈도우 크기를 선형적으로 증가시켜 네트워크 안정성을 유지.

#### 3) **Fast Retransmit (빠른 재전송)**
- 중복 ACK(같은 ACK가 여러 번 도착)를 감지하면 즉시 손실된 패킷을 재전송.

#### 4) **Fast Recovery (빠른 복구)**
- 패킷 손실 후 혼잡 윈도우를 절반으로 줄이고 선형 증가를 시작하여 빠르게 복구.

---

### **2.4 예시**

#### 혼잡 제어 시나리오:
1. 초기 혼잡 윈도우 크기가 1KB로 설정됨(Slow Start).
2. ACK를 받을 때마다 혼잡 윈도우가 지수적으로 증가(1KB → 2KB → 4KB).
3. 혼잡 임계값(Threshold)에 도달하면 선형적으로 증가(Congestion Avoidance).
4. 패킷 손실 발생 시, 혼잡 윈도우를 절반으로 감소(Fast Recovery).

---

## **TCP 흐름 제어와 혼잡 제어 비교**

| 항목               | 흐름 제어 (Flow Control)                           | 혼잡 제어 (Congestion Control)                         |
|--------------------|---------------------------------------------------|-------------------------------------------------------|
| 목적               | 수신 측의 처리 능력을 초과하지 않도록 조절          | 네트워크 내 트래픽 과부하 방지                         |
| 기준               | 수신 측의 버퍼 상태                                | 네트워크 상태                                         |
| 주요 요소          | 수신 윈도우(Window Size)                          | 혼잡 윈도우(Congestion Window), 임계값(Threshold)     |
| 적용 범위          | 송신자 ↔ 수신자 간                                  | 전체 네트워크                                         |
| 알고리즘           | 슬라이딩 윈도우                                   | Slow Start, Congestion Avoidance, Fast Retransmit 등 |

---

## 요약

### 흐름 제어
- 송수신 간 데이터 전송 속도를 조절하여 수신 측 버퍼 오버플로우 방지.
- 주요 방식: 정지-대기(Stop-and-Wait), 슬라이딩 윈도우(Sliding Window).

### 혼잡 제어
- 네트워크 내 트래픽 과부하를 방지하고 안정성을 유지하기 위한 메커니즘.
- 주요 알고리즘: Slow Start, Congestion Avoidance, Fast Retransmit, Fast Recovery.

TCP는 이러한 흐름 제어와 혼잡 제어 메커니즘을 통해 신뢰성 있는 데이터 전송과 효율적인 네트워크 자원 관리를 보장합니다.
